<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ - Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 5px;
            font-weight: bold;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: var(--success-color);
        }
        
        .btn-danger {
            background: var(--danger-color);
        }
        
        .btn-warning {
            background: var(--warning-color);
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .teacher-info {
            background: linear-gradient(135deg, var(--light-color), #fff);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            border: 2px solid var(--primary-color);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: var(--primary-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        th {
            background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .result-cell {
            font-weight: bold;
            text-align: center;
            font-size: 13px;
            padding: 8px 5px;
            border-radius: 5px;
        }
        
        .result-excellent {
            color: var(--success-color);
            background-color: rgba(39, 174, 96, 0.1);
        }
        
        .result-good {
            color: var(--primary-color);
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .result-average {
            color: var(--warning-color);
            background-color: rgba(243, 156, 18, 0.1);
        }
        
        .result-poor {
            color: var(--danger-color);
            background-color: rgba(231, 76, 60, 0.1);
        }
        
        .edit-btn {
            background: var(--warning-color);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin: 2px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal-content {
            background: white;
            margin: 2% auto;
            padding: 25px;
            border-radius: 15px;
            width: 95%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            background: #f0f0f0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .student-form {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .form-section {
            grid-column: 1 / -1;
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .form-section h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            background: #fff;
        }
        
        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid var(--light-color);
        }
        
        .search-section {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .search-section > * {
            flex: 1;
            min-width: 200px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .student-form {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .search-section {
                flex-direction: column;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 4px;
            }
            
            .modal-content {
                margin: 5% auto;
                padding: 15px;
                width: 98%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
            <p>Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙ‚ÙŠÙŠÙ… Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Excel</p>
        </header>

        <!-- Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
        <div class="section">
            <h2>ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <div class="action-buttons">
                <button id="loadExcelBtn" class="btn btn-success">ğŸ“‚ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Excel</button>
                <button id="exportExcelBtn" class="btn btn-primary">ğŸ“„ ØªØµØ¯ÙŠØ± Ù„Ù€ Excel</button>
                <button id="addStudentBtn" class="btn btn-warning">â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
            </div>
            
            <div id="dataInfo" class="teacher-info">
                <strong>ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> 
                <span id="dataStatus">ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©</span> | 
                <strong>ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨:</strong> 
                <span id="studentsCount">0</span>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div id="statsSection" class="section hidden">
            <h2>ğŸ“ˆ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
            <div class="stats-grid" id="statsGrid">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© -->
        <div id="searchSection" class="section hidden">
            <h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©</h2>
            <div class="search-section">
                <div class="form-group">
                    <label for="classFilter">ğŸ« Ø§Ù„Ø´Ø¹Ø¨Ø©:</label>
                    <select id="classFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="nameSearch">ğŸ“ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…:</label>
                    <input type="text" id="nameSearch" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨...">
                </div>
                <div class="form-group">
                    <label for="barcodeSearch">ğŸ”¢ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯:</label>
                    <input type="text" id="barcodeSearch" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯...">
                </div>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
        <div id="mainSection" class="section hidden">
            <h2>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h2>
            
            <div id="loading" class="loading hidden">
                <p>â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
            </div>

            <div style="overflow-x: auto;">
                <table id="studentsTable">
                    <thead>
                        <tr>
                            <th>ğŸ”¢ ID</th>
                            <th>ğŸ“‹ Barcode</th>
                            <th>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…</th>
                            <th>ğŸ« Ø§Ù„Ø´Ø¹Ø¨Ø©</th>
                            <th>ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 1</th>
                            <th>ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 1</th>
                            <th>ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 1</th>
                            <th>âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 1</th>
                            <th>ğŸ§® Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 1</th>
                            <th>â­ Ù…Ø­ØµÙ„Ø© 1</th>
                            <th>ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 2</th>
                            <th>ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 2</th>
                            <th>ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 2</th>
                            <th>âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 2</th>
                            <th>ğŸ§® Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 2</th>
                            <th>â­ Ù…Ø­ØµÙ„Ø© 2</th>
                            <th>ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 3</th>
                            <th>ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 3</th>
                            <th>ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 3</th>
                            <th>âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 3</th>
                            <th>ğŸ§® Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 3</th>
                            <th>â­ Ù…Ø­ØµÙ„Ø© 3</th>
                            <th>ğŸ“ Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                            <th>ğŸ”‘ Ø§Ù„Ù…Ø¹Ø±Ù</th>
                            <th>âŒ ØºÙŠØ§Ø¨ 1</th>
                            <th>âŒ ØºÙŠØ§Ø¨ 2</th>
                            <th>âŒ ØºÙŠØ§Ø¨ 3</th>
                            <th>âš™ï¸ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
                <form id="studentForm" class="student-form">
                    <input type="hidden" id="editStudentId">
                    <input type="hidden" id="editStudentIndex">
                    
                    <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                    <div class="form-section">
                        <h4>ğŸ“‹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h4>
                    </div>
                    <div class="form-group">
                        <label for="editBarcode">ğŸ“‹ Barcode:</label>
                        <input type="text" id="editBarcode">
                    </div>
                    <div class="form-group">
                        <label for="editName">ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</label>
                        <input type="text" id="editName">
                    </div>
                    <div class="form-group">
                        <label for="editClass">ğŸ« Ø§Ù„Ø´Ø¹Ø¨Ø©:</label>
                        <input type="text" id="editClass">
                    </div>
                    <div class="form-group">
                        <label for="editSubject">ğŸ“ Ø§Ù„Ù…Ø§Ø¯Ø©:</label>
                        <input type="text" id="editSubject">
                    </div>

                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„ -->
                    <div class="form-section">
                        <h4>ğŸ“˜ Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance1">ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 1:</label>
                        <input type="number" id="editAttendance1" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editOral1">ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 1:</label>
                        <input type="number" id="editOral1" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editHomework1">ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 1:</label>
                        <input type="number" id="editHomework1" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editWritten1">âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 1:</label>
                        <input type="number" id="editWritten1" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editAbsence1">âŒ ØºÙŠØ§Ø¨ 1:</label>
                        <input type="number" id="editAbsence1" min="0" max="100" step="1">
                    </div>

                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                    <div class="form-section">
                        <h4>ğŸ“— Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance2">ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 2:</label>
                        <input type="number" id="editAttendance2" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editOral2">ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 2:</label>
                        <input type="number" id="editOral2" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editHomework2">ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 2:</label>
                        <input type="number" id="editHomework2" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editWritten2">âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 2:</label>
                        <input type="number" id="editWritten2" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editAbsence2">âŒ ØºÙŠØ§Ø¨ 2:</label>
                        <input type="number" id="editAbsence2" min="0" max="100" step="1">
                    </div>

                    <!-- Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø« -->
                    <div class="form-section">
                        <h4>ğŸ“™ Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«</h4>
                    </div>
                    <div class="form-group">
                        <label for="editAttendance3">ğŸ“Š Ù…ÙˆØ§Ø¸Ø¨Ø© 3:</label>
                        <input type="number" id="editAttendance3" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editOral3">ğŸ—£ï¸ Ø´ÙÙ‡ÙŠ 3:</label>
                        <input type="number" id="editOral3" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editHomework3">ğŸ“š ÙˆØ§Ø¬Ø¨Ø§Øª 3:</label>
                        <input type="number" id="editHomework3" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editWritten3">âœï¸ ØªØ­Ø±ÙŠØ±ÙŠ 3:</label>
                        <input type="number" id="editWritten3" min="0" max="20" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="editAbsence3">âŒ ØºÙŠØ§Ø¨ 3:</label>
                        <input type="number" id="editAbsence3" min="0" max="100" step="1">
                    </div>

                    <div class="form-section">
                        <button type="submit" class="btn btn-success">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                        <button type="button" id="cancelEditBtn" class="btn btn-danger">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // ========== Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==========
        class StudentManager {
            constructor() {
                this.students = [];
                this.filteredStudents = [];
                this.localStorageKey = 'students_data';
            }

            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù Excel
            async loadFromExcel(file) {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        try {
                            const arrayBuffer = e.target.result;
                            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                            const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                            
                            this.parseExcelData(jsonData);
                            this.saveToLocalStorage();
                            
                            resolve(true);
                            
                        } catch (error) {
                            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:', error);
                            resolve(false);
                        }
                    };
                    
                    reader.onerror = () => resolve(false);
                    reader.readAsArrayBuffer(file);
                });
            }

            // ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Excel Ø­Ø³Ø¨ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
            parseExcelData(sheetData) {
                if (sheetData.length < 2) {
                    this.students = [];
                    return;
                }

                const headers = sheetData[0];
                console.log('ğŸ” Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:', headers);

                this.students = [];
                
                for (let i = 1; i < sheetData.length; i++) {
                    const row = sheetData[i];
                    if (row.length === 0) continue;

                    const student = {
                        id: row[0] || `STD${i}`,
                        barcode: row[1] || '',
                        name: row[2] || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…',
                        class: row[3] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                        // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
                        attendance1: this.formatGrade(row[4]),
                        oral1: this.formatGrade(row[5]),
                        homework1: this.formatGrade(row[6]),
                        written1: this.formatGrade(row[7]),
                        total1: this.formatGrade(row[8]),
                        result1: this.formatGrade(row[9]),
                        // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
                        attendance2: this.formatGrade(row[10]),
                        oral2: this.formatGrade(row[11]),
                        homework2: this.formatGrade(row[12]),
                        written2: this.formatGrade(row[13]),
                        total2: this.formatGrade(row[14]),
                        result2: this.formatGrade(row[15]),
                        // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
                        attendance3: this.formatGrade(row[16]),
                        homework3: this.formatGrade(row[17]),
                        oral3: this.formatGrade(row[18]),
                        written3: this.formatGrade(row[19]),
                        total3: this.formatGrade(row[20]),
                        result3: this.formatGrade(row[21]),
                        // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                        subject: row[22] || '',
                        identifier: row[23] || '',
                        absence1: row[24] || '0',
                        absence2: row[25] || '0',
                        absence3: row[26] || '0'
                    };

                    this.students.push(student);
                }

                this.filteredStudents = [...this.students];
                console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${this.students.length} Ø·Ø§Ù„Ø¨`);
            }

            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
            formatGrade(value) {
                if (value === null || value === undefined || value === '') return '0';
                if (typeof value === 'number') return value.toString();
                return value.toString().trim();
            }

            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
            saveToLocalStorage() {
                try {
                    const dataToSave = {
                        students: this.students,
                        lastUpdate: new Date().toISOString()
                    };
                    localStorage.setItem(this.localStorageKey, JSON.stringify(dataToSave));
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ù„ÙŠ:', error);
                    return false;
                }
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            loadFromLocalStorage() {
                try {
                    const savedData = localStorage.getItem(this.localStorageKey);
                    if (!savedData) return false;
                    
                    const parsedData = JSON.parse(savedData);
                    this.students = parsedData.students || [];
                    this.filteredStudents = [...this.students];
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ù„ÙŠ:', error);
                    return false;
                }
            }

            // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù€ Excel
            exportToExcel() {
                try {
                    const data = this.prepareExportData();
                    const worksheet = XLSX.utils.aoa_to_sheet(data);
                    const workbook = XLSX.utils.book_new();
                    
                    XLSX.utils.book_append_sheet(workbook, worksheet, 'Ø§Ù„Ø·Ù„Ø§Ø¨');
                    
                    const fileName = `Ø·Ù„Ø§Ø¨_${new Date().toLocaleDateString('ar-EG')}.xlsx`;
                    XLSX.writeFile(workbook, fileName);
                    
                    return true;
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±:', error);
                    return false;
                }
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
            prepareExportData() {
                const headers = [
                    'ID', 'Barcode', 'Ø§Ù„Ø§Ø³Ù…', 'Ø§Ù„Ø´Ø¹Ø¨Ø©',
                    'Ù…ÙˆØ§Ø¸Ø¨Ø© 1', 'Ø´ÙÙ‡ÙŠ 1', 'ÙˆØ§Ø¬Ø¨Ø§Øª 1', 'ØªØ­Ø±ÙŠØ±ÙŠ 1', 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 1', 'Ù…Ø­ØµÙ„Ø© 1',
                    'Ù…ÙˆØ§Ø¸Ø¨Ø© 2', 'Ø´ÙÙ‡ÙŠ 2', 'ÙˆØ§Ø¬Ø¨Ø§Øª 2', 'ØªØ­Ø±ÙŠØ±ÙŠ 2', 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 2', 'Ù…Ø­ØµÙ„Ø© 2',
                    'Ù…ÙˆØ§Ø¸Ø¨Ø© 3', 'ÙˆØ§Ø¬Ø¨Ø§Øª 3', 'Ø´ÙÙ‡ÙŠ 3', 'ØªØ­Ø±ÙŠØ±ÙŠ 3', 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 3', 'Ù…Ø­ØµÙ„Ø© 3',
                    'Ø§Ù„Ù…Ø§Ø¯Ø©', 'Ø§Ù„Ù…Ø¹Ø±Ù', 'ØºÙŠØ§Ø¨ 1', 'ØºÙŠØ§Ø¨ 2', 'ØºÙŠØ§Ø¨ 3'
                ];
                
                const data = [headers];
                
                this.students.forEach(student => {
                    const row = [
                        student.id,
                        student.barcode,
                        student.name,
                        student.class,
                        student.attendance1,
                        student.oral1,
                        student.homework1,
                        student.written1,
                        student.total1,
                        student.result1,
                        student.attendance2,
                        student.oral2,
                        student.homework2,
                        student.written2,
                        student.total2,
                        student.result2,
                        student.attendance3,
                        student.homework3,
                        student.oral3,
                        student.written3,
                        student.total3,
                        student.result3,
                        student.subject,
                        student.identifier,
                        student.absence1,
                        student.absence2,
                        student.absence3
                    ];
                    
                    data.push(row);
                });
                
                return data;
            }

            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø·Ø§Ù„Ø¨
            updateStudent(index, updates) {
                if (index < 0 || index >= this.students.length) return false;
                
                this.students[index] = { ...this.students[index], ...updates };
                this.filteredStudents[index] = { ...this.filteredStudents[index], ...updates };
                this.saveToLocalStorage();
                
                return true;
            }

            // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
            addStudent(studentData) {
                const newStudent = {
                    id: studentData.id || `STD${this.students.length + 1}`,
                    barcode: studentData.barcode || '',
                    name: studentData.name || 'Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯',
                    class: studentData.class || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    attendance1: studentData.attendance1 || '0',
                    oral1: studentData.oral1 || '0',
                    homework1: studentData.homework1 || '0',
                    written1: studentData.written1 || '0',
                    total1: studentData.total1 || '0',
                    result1: studentData.result1 || '0',
                    attendance2: studentData.attendance2 || '0',
                    oral2: studentData.oral2 || '0',
                    homework2: studentData.homework2 || '0',
                    written2: studentData.written2 || '0',
                    total2: studentData.total2 || '0',
                    result2: studentData.result2 || '0',
                    attendance3: studentData.attendance3 || '0',
                    homework3: studentData.homework3 || '0',
                    oral3: studentData.oral3 || '0',
                    written3: studentData.written3 || '0',
                    total3: studentData.total3 || '0',
                    result3: studentData.result3 || '0',
                    subject: studentData.subject || '',
                    identifier: studentData.identifier || '',
                    absence1: studentData.absence1 || '0',
                    absence2: studentData.absence2 || '0',
                    absence3: studentData.absence3 || '0'
                };
                
                this.students.push(newStudent);
                this.filteredStudents.push(newStudent);
                this.saveToLocalStorage();
                
                return true;
            }

            // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©
            filterStudents(filters) {
                this.filteredStudents = this.students.filter(student => {
                    if (filters.class && student.class !== filters.class) return false;
                    if (filters.name && !student.name.includes(filters.name)) return false;
                    if (filters.barcode && !student.barcode.includes(filters.barcode)) return false;
                    return true;
                });
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø¹Ø¨
            getClasses() {
                const classes = new Set(this.students.map(s => s.class).filter(c => c));
                return Array.from(classes);
            }

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            getStatistics() {
                const stats = {
                    total: this.students.length,
                    excellent: 0,
                    good: 0,
                    average: 0,
                    poor: 0,
                    classes: this.getClasses().length
                };
                
                this.students.forEach(student => {
                    const avg = (parseFloat(student.result1 || 0) + 
                                parseFloat(student.result2 || 0) + 
                                parseFloat(student.result3 || 0)) / 3;
                    
                    if (avg >= 4.5) stats.excellent++;
                    else if (avg >= 3.5) stats.good++;
                    else if (avg >= 2.5) stats.average++;
                    else stats.poor++;
                });
                
                return stats;
            }
        }

        // ========== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ==========
        const studentManager = new StudentManager();
        let currentEditIndex = -1;

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function initializeApp() {
            setupEventListeners();
            loadInitialData();
        }

        function setupEventListeners() {
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
            document.getElementById('loadExcelBtn').addEventListener('click', handleFileLoad);
            document.getElementById('exportExcelBtn').addEventListener('click', handleExport);
            document.getElementById('addStudentBtn').addEventListener('click', showAddStudentForm);
            
            // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©
            document.getElementById('classFilter').addEventListener('change', applyFilters);
            document.getElementById('nameSearch').addEventListener('input', applyFilters);
            document.getElementById('barcodeSearch').addEventListener('input', applyFilters);
            
            // Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            document.querySelector('.close-modal').addEventListener('click', closeEditModal);
            document.getElementById('cancelEditBtn').addEventListener('click', closeEditModal);
            document.getElementById('studentForm').addEventListener('submit', handleFormSubmit);
        }

        function loadInitialData() {
            if (studentManager.loadFromLocalStorage()) {
                updateUI();
                showSuccess('ğŸ“‚ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©');
            }
        }

        function handleFileLoad() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.xlsx, .xls';
            
            fileInput.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    showLoading(true);
                    const success = await studentManager.loadFromExcel(file);
                    showLoading(false);
                    
                    if (success) {
                        updateUI();
                        showSuccess(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${studentManager.students.length} Ø·Ø§Ù„Ø¨`);
                    } else {
                        showError('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù');
                    }
                }
            };
            
            fileInput.click();
        }

        function handleExport() {
            if (studentManager.students.length === 0) {
                showError('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            if (studentManager.exportToExcel()) {
                showSuccess('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                showError('âŒ ÙØ´Ù„ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }

        function updateUI() {
            updateDataInfo();
            updateStats();
            updateClassFilter();
            renderStudentsTable();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª
            if (studentManager.students.length > 0) {
                document.getElementById('statsSection').classList.remove('hidden');
                document.getElementById('searchSection').classList.remove('hidden');
                document.getElementById('mainSection').classList.remove('hidden');
            }
        }

        function updateDataInfo() {
            document.getElementById('dataStatus').textContent = 
                studentManager.students.length > 0 ? 'Ù…Ø­Ù…Ù„Ø©' : 'ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©';
            document.getElementById('studentsCount').textContent = studentManager.students.length;
        }

        function updateStats() {
            const stats = studentManager.getStatistics();
            const statsGrid = document.getElementById('statsGrid');
            
            statsGrid.innerHTML = `
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--primary-color);">${stats.total}</div>
                    <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                </div>
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--success-color);">${stats.excellent}</div>
                    <div>Ù…Ù…ØªØ§Ø²</div>
                </div>
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--primary-color);">${stats.good}</div>
                    <div>Ø¬ÙŠØ¯</div>
                </div>
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--warning-color);">${stats.average}</div>
                    <div>Ù…ØªÙˆØ³Ø·</div>
                </div>
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--danger-color);">${stats.poor}</div>
                    <div>Ø¶Ø¹ÙŠÙ</div>
                </div>
                <div class="stat-item">
                    <div style="font-size: 24px; color: var(--secondary-color);">${stats.classes}</div>
                    <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø¹Ø¨</div>
                </div>
            `;
        }

        function updateClassFilter() {
            const classFilter = document.getElementById('classFilter');
            const classes = studentManager.getClasses();
            
            classFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>';
            classes.forEach(className => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                classFilter.appendChild(option);
            });
        }

        function renderStudentsTable() {
            const tbody = document.getElementById('studentsTableBody');
            const students = studentManager.filteredStudents;
            
            if (students.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="28" style="text-align: center; padding: 40px; color: #666;">
                            ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = students.map((student, index) => `
                <tr>
                    <td>${student.id}</td>
                    <td>${student.barcode}</td>
                    <td><strong>${student.name}</strong></td>
                    <td>${student.class}</td>
                    <td>${student.attendance1}</td>
                    <td>${student.oral1}</td>
                    <td>${student.homework1}</td>
                    <td>${student.written1}</td>
                    <td><strong>${student.total1}</strong></td>
                    <td class="result-cell ${getResultClass(student.result1)}">${student.result1}</td>
                    <td>${student.attendance2}</td>
                    <td>${student.oral2}</td>
                    <td>${student.homework2}</td>
                    <td>${student.written2}</td>
                    <td><strong>${student.total2}</strong></td>
                    <td class="result-cell ${getResultClass(student.result2)}">${student.result2}</td>
                    <td>${student.attendance3}</td>
                    <td>${student.homework3}</td>
                    <td>${student.oral3}</td>
                    <td>${student.written3}</td>
                    <td><strong>${student.total3}</strong></td>
                    <td class="result-cell ${getResultClass(student.result3)}">${student.result3}</td>
                    <td>${student.subject}</td>
                    <td>${student.identifier}</td>
                    <td>${student.absence1}</td>
                    <td>${student.absence2}</td>
                    <td>${student.absence3}</td>
                    <td>
                        <button class="edit-btn" onclick="openEditModal(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                    </td>
                </tr>
            `).join('');
        }

        function getResultClass(result) {
            const value = parseFloat(result) || 0;
            if (value >= 4.5) return 'result-excellent';
            if (value >= 3.5) return 'result-good';
            if (value >= 2.5) return 'result-average';
            return 'result-poor';
        }

        function applyFilters() {
            const filters = {
                class: document.getElementById('classFilter').value,
                name: document.getElementById('nameSearch').value,
                barcode: document.getElementById('barcodeSearch').value
            };
            
            studentManager.filterStudents(filters);
            renderStudentsTable();
        }

        function openEditModal(index) {
            const student = studentManager.filteredStudents[index];
            if (!student) return;
            
            currentEditIndex = studentManager.students.findIndex(s => s.id === student.id);
            
            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„
            document.getElementById('editStudentId').value = student.id;
            document.getElementById('editStudentIndex').value = currentEditIndex;
            document.getElementById('editBarcode').value = student.barcode;
            document.getElementById('editName').value = student.name;
            document.getElementById('editClass').value = student.class;
            document.getElementById('editSubject').value = student.subject;
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
            document.getElementById('editAttendance1').value = student.attendance1;
            document.getElementById('editOral1').value = student.oral1;
            document.getElementById('editHomework1').value = student.homework1;
            document.getElementById('editWritten1').value = student.written1;
            document.getElementById('editAbsence1').value = student.absence1;
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
            document.getElementById('editAttendance2').value = student.attendance2;
            document.getElementById('editOral2').value = student.oral2;
            document.getElementById('editHomework2').value = student.homework2;
            document.getElementById('editWritten2').value = student.written2;
            document.getElementById('editAbsence2').value = student.absence2;
            
            // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
            document.getElementById('editAttendance3').value = student.attendance3;
            document.getElementById('editOral3').value = student.oral3;
            document.getElementById('editHomework3').value = student.homework3;
            document.getElementById('editWritten3').value = student.written3;
            document.getElementById('editAbsence3').value = student.absence3;
            
            document.getElementById('editModal').style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('studentForm').reset();
            currentEditIndex = -1;
        }

        function showAddStudentForm() {
            currentEditIndex = -1;
            document.getElementById('studentForm').reset();
            document.getElementById('editStudentId').value = `STD${studentManager.students.length + 1}`;
            document.getElementById('editModal').style.display = 'block';
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                id: document.getElementById('editStudentId').value,
                barcode: document.getElementById('editBarcode').value,
                name: document.getElementById('editName').value,
                class: document.getElementById('editClass').value,
                subject: document.getElementById('editSubject').value,
                // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„
                attendance1: document.getElementById('editAttendance1').value,
                oral1: document.getElementById('editOral1').value,
                homework1: document.getElementById('editHomework1').value,
                written1: document.getElementById('editWritten1').value,
                absence1: document.getElementById('editAbsence1').value,
                // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ
                attendance2: document.getElementById('editAttendance2').value,
                oral2: document.getElementById('editOral2').value,
                homework2: document.getElementById('editHomework2').value,
                written2: document.getElementById('editWritten2').value,
                absence2: document.getElementById('editAbsence2').value,
                // Ø§Ù„ØªØ±Ù… Ø§Ù„Ø«Ø§Ù„Ø«
                attendance3: document.getElementById('editAttendance3').value,
                oral3: document.getElementById('editOral3').value,
                homework3: document.getElementById('editHomework3').value,
                written3: document.getElementById('editWritten3').value,
                absence3: document.getElementById('editAbsence3').value
            };
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ ÙˆØ§Ù„Ù…Ø­ØµÙ„Ø§Øª
            formData.total1 = calculateTotal(formData, 1);
            formData.result1 = calculateResult(formData, 1);
            formData.total2 = calculateTotal(formData, 2);
            formData.result2 = calculateResult(formData, 2);
            formData.total3 = calculateTotal(formData, 3);
            formData.result3 = calculateResult(formData, 3);
            
            let success = false;
            
            if (currentEditIndex >= 0) {
                success = studentManager.updateStudent(currentEditIndex, formData);
            } else {
                success = studentManager.addStudent(formData);
            }
            
            if (success) {
                updateUI();
                closeEditModal();
                showSuccess(currentEditIndex >= 0 ? 'âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­' : 'âœ… ØªÙ… Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                showError('âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }

        function calculateTotal(student, term) {
            const attendance = parseFloat(student[`attendance${term}`]) || 0;
            const oral = parseFloat(student[`oral${term}`]) || 0;
            const homework = parseFloat(student[`homework${term}`]) || 0;
            const written = parseFloat(student[`written${term}`]) || 0;
            
            return (attendance + oral + homework + written).toFixed(1);
        }

        function calculateResult(student, term) {
            const total = parseFloat(calculateTotal(student, term));
            return (total / 4).toFixed(1); // Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
        }

        function showLoading(show) {
            const loadingDiv = document.getElementById('loading');
            if (show) {
                loadingDiv.classList.remove('hidden');
            } else {
                loadingDiv.classList.add('hidden');
            }
        }

        function showSuccess(message) {
            alert(message);
        }

        function showError(message) {
            alert(message);
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>